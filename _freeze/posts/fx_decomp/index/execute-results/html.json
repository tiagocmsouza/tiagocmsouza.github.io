{
  "hash": "ca100727e825cf6eff0ecff54bc1d283",
  "result": {
    "markdown": "---\ntitle: \"FX Decomposition using Dynamic Factor Models\"\nauthor: \"Tiago Souza\"\ndate: \"2022-09-11\"\ncategories: [DFM, python]\n---\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport eurostat\nfrom datetime import datetime\n```\n:::\n\n\nThis post is to apply a Dynamic Factor Model to uncover common trends in currencies as well as idiosyncratic shocks that some countries might be facing.\n\n\n$$\n\\begin{aligned}\nx^{i}_{t} = \\alpha^{i} + \\sum_{j}{\\beta^{i}_{j} f_{j} + \\varepsilon^{i}_{t}}, \\quad i = 1 \\dots n\n\\end{aligned}\n$$\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\ndf = eurostat.get_data_df('ert_bil_eur_d', flags=False)\ndf.rename(columns = {'currency\\\\time': 'currency'}, inplace = True)\n\nlist_statinfo = ['AVG']\nlist_currency = ['AUD', 'BRL', 'CAD', 'CHF', 'CNY', 'CZK', 'GBP', 'HUF', 'IDR', 'JPY', 'MXN', 'NZD', 'PLN', 'TRY', 'USD', 'ZAR']\n\ndf = df[(df['statinfo'].isin(list_statinfo)) & (df['currency'].isin(list_currency))]\ndf.drop(columns = ['unit', 'statinfo'], inplace = True)\n\ndf = pd.melt(df, id_vars = ['currency'], var_name = 'date')\ndf['date'] = df['date'].apply(lambda x: datetime.strptime(x, '%YM%mD%d'))\ndf.set_index(['date', 'currency'], inplace = True)\n\ndf = df.unstack()\ndf[('value', 'EUR')] = 1\ndf = df.mul(1 / df.loc[:,('value', 'USD')], axis = 0)\ndf.drop('USD', axis = 1, level = 'currency', inplace = True)\n\nprint(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n               value                                                     \\\ncurrency         AUD       BRL       CAD       CHF       CNY        CZK   \ndate                                                                      \n1974-07-01       NaN       NaN       NaN  2.995941       NaN        NaN   \n1974-07-02       NaN       NaN       NaN  2.990800       NaN        NaN   \n1974-07-03       NaN       NaN       NaN  2.966785       NaN        NaN   \n1974-07-04       NaN       NaN       NaN  2.977922       NaN        NaN   \n1974-07-05       NaN       NaN       NaN  2.975646       NaN        NaN   \n...              ...       ...       ...       ...       ...        ...   \n2022-09-05  1.473387  5.182157  1.314819  0.982560  6.932258  24.820565   \n2022-09-06  1.475725  5.167204  1.312349  0.981567  6.959206  24.728042   \n2022-09-07  1.491958  5.248457  1.318867  0.986343  6.977036  24.917552   \n2022-09-08  1.481067  5.199520  1.312219  0.973024  6.950145  24.520931   \n2022-09-09  1.463230  5.183302  1.300627  0.960991  6.920390  24.416360   \n\n                                                                       \\\ncurrency         GBP         HUF           IDR         JPY        MXN   \ndate                                                                    \n1974-07-01  0.419092         NaN           NaN         NaN        NaN   \n1974-07-02  0.418334         NaN           NaN         NaN        NaN   \n1974-07-03  0.417764         NaN           NaN         NaN        NaN   \n1974-07-04  0.419530         NaN           NaN         NaN        NaN   \n1974-07-05  0.418713         NaN           NaN         NaN        NaN   \n...              ...         ...           ...         ...        ...   \n2022-09-05  0.870544  407.157258  14902.046371  140.594758  19.979032   \n2022-09-06  0.863648  405.570105  14891.156326  141.931910  19.998489   \n2022-09-07  0.875164  406.504805  14951.411229  144.865959  20.154274   \n2022-09-08  0.865781  395.124388  14878.469378  143.520831  19.995004   \n2022-09-09  0.864365  394.367599  14832.650015  142.601254  19.893522   \n\n                                                                \ncurrency         NZD       PLN        TRY        ZAR       EUR  \ndate                                                            \n1974-07-01       NaN       NaN        NaN        NaN  0.828295  \n1974-07-02       NaN       NaN        NaN        NaN  0.828844  \n1974-07-03       NaN       NaN        NaN        NaN  0.826241  \n1974-07-04       NaN       NaN        NaN        NaN  0.830013  \n1974-07-05       NaN       NaN        NaN        NaN  0.828363  \n...              ...       ...        ...        ...       ...  \n2022-09-05  1.642036  4.774194  18.225000  17.225806  1.008065  \n2022-09-06  1.643131  4.740935  18.225020  17.204371  1.007252  \n2022-09-07  1.665048  4.784016  18.235913  17.458978  1.011634  \n2022-09-08  1.647617  4.711260  18.238186  17.364072  0.999101  \n2022-09-09  1.638272  4.697980  18.238830  17.290576  0.995124  \n\n[12435 rows x 16 columns]\n```\n:::\n:::\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {}
  }
}